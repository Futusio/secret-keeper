{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='csrf' content='{% csrf_token %}'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <script 
        src="https://code.jquery.com/jquery-3.5.1.js" 
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" 
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="{% static 'js/main.js' %}"></script>
</head>
<body>

    <style>
        #super_body {
            /* width: 1000px;
            height: 900px; */
            width: 100%;
            height: 100%;
        }
    
        #main_field {
            display: flex;
            justify-content: space-between;
    
        }
    
        #notifications {
            margin-left: 50px;
            width: 225px;
            min-width: 225px;
            height: 100%;
            /* background-color: red; */
        }
    
        #notifications > div {
            border-bottom: 1px solid black;
            text-align: center;
        }
    
        #notifications > div > h3 {
            margin: 10px 0;
        }
    
        #screen {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
    </style>

    <script>
        // Set CSRF Token
        function csrfSafeMethod(method) {
            // these HTTP methods do not require CSRF protection
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }

        $(document).ready(function(){
            csrftoken = $("input[name=csrfmiddlewaretoken]").attr("value")

            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                }
            });
        });
        
        // Next part
        // Close popul if click ovveride
        $(document).on('click', '#popup', function(e){
            if(!$(e.target).closest(".popup").length) {
                $('.popup').fadeOut(200).after(function(e){
                    $('#popup').fadeOut(300)
                    cleanUp()
                })
            }
        })
        // Or if click Escape
        $(document).keyup(function(e) {
            if(e.keyCode == 27 && $('.popup').is(":visible")) {
                $('.popup').fadeOut(200).after(function(e){
                    $('#popup').fadeOut(300)
                    cleanUp()
                })
            }
        })

        $(document).on('click', '#end', function(e){
            $('#popup').fadeIn(300)
            $('#popup_group').fadeIn(300)
        })

        $(document).on('click', '.add-account', function(e){
            group_id = $(e.target).parent().parent().attr('id')
            $('#popup').fadeIn(300)
            $('#popup_account').fadeIn(300)
        })

        $(document).on('click', '.group', function(e){
            if(!$(e.target).hasClass('group')) return NaN 
            $('div').removeClass('selected-group')
            $('.actions').remove()
            $(e.target).addClass('selected-group')
            $(e.target).append(`
                <div class='actions'><span class='sidebar-action add-account'>+</span><span class='sidebar-action del-group'>x</span></div>
            `)
            // Get Accounts to the group
            // var id = $(e.target).parent().parent().attr('id')
            // var accounts = getAccounts(id)

        })

        $(document).on('click', '.click', function(e){
            group_id = $(e.target).parent().attr('id')
            $('#popup').fadeIn(300)
            $('#popup_account_show').fadeIn(300)
        })
        
        $(document).on('click', '.del-group', function(e){
            delGroup(e)
        })


    </script>

<!-- Left Sidebar -->
<section id=sidebar>
    <header>
        Secret Keeper
    </header>
    <section id='group-list'>
        <div class="group" >Name</div>
        {% for group in groups %}
            <div class="group" id="{{ group.id }}">{{ group.name }}</div>
        {% endfor %}
    </section>
    <div id='end'>Add group</div>
</section>

<div id='super_body'>
    <!-- Headers -->
    <div id='cap'>
        <h3 style='margin: 0;'>Hello, biitch</h3>
            <form action="/logout" method="POST">
                {% csrf_token %}
                <input type="submit" value="logout">
            </form>
    </div>
    <!-- Main Screen includes accounts and notifications -->
    <div id='main_field'>
        <div id='screen'>
            <div class='min-account' id='1'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click' >открыть</div>
            </div>
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>   
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click' onclick="">открыть</div>
            </div>   
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>   
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>     
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>   
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>   
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>   

            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>     
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>     
            
            <div class='min-account'>
                <div class='name'>Hello, bitch</div>
                <div class='description'>A very large text A very large textA very large text A very large text A very large text A very large text A very large text </div>
                <div class='click'>открыть</div>
            </div>     
        </div>
        
        <div id='notifications'>
            <div><h3>Уведомления:</h3></div>

        </div>
    </div>
</div> 

<div class="b-popup" id="popup" style="display: none;">
    <!-- Message window-->
    <!-- Group popUp -->
    <div class="popup" id='popup_group' style="display: none;">
        <div class='pop_head'><p>Новая группа</p></div>
        <div class='pop_field'><p>Название:</p><input id='new_group'/></div>
        <div class='pop_footer'>
            <button style="border-bottom-right-radius: 3px;;border-bottom-left-radius: 3px;" onclick="addGroup()">Создать</button>
        </div>
    </div>
    <!-- Usability popUp -->
    <div class='popup' id='popup_account' style="display: none;">
        <div class='pop_head'><p>Создать аккаунт</p></div>
        <div class='pop_field'><p>Название:</p><input id='account_name' autocomplete="off"/></div>
        <div class='pop_field'><p>Логин:</p><input id='account_login'autocomplete="off"/></div>
        <div class='pop_field'><p>Пароль:</p><input type="password" id='account_password'autocomplete="new-password"/></div>
        <div class='pop_field'><p>URL:</p><input id='account_url' autocomplete="off"/></div>
        <div class='pop_field dsc'><p>Описание:</p><br><small class='pop_small'>необязательно</small></div>
        <div class="pop_field"><textarea id='account_description'></textarea></div>
        <div class='pop_footer'>
            <button style=" border-bottom-right-radius: 3px;" id='create_account' onclick="addAccount()">Создать</button>
        </div>
    </div>
    <div class='popup' id='popup_account_show' style="display: none;">
        <div class='pop_head'><p>Аккаунт</p></div>
        <div class='pop_field'><p>Название:</p><input id='account_name' disabled autocomplete="off"/></div>
        <div class='pop_field'><p>Логин:</p><input id='account_login' disabled autocomplete="off"/></div>
        <div class='pop_field'><p>Пароль:</p><input type="password" disabled id='account_password'autocomplete="new-password"/></div>
        <div class='pop_field'><p>URL:</p><input id='account_url' disabled autocomplete="off"/></div>
        <div class='pop_field dsc'><p>Описание:</p></div>
        <div class="pop_field"><textarea disabled id='account_description'></textarea></div>
        <div class='pop_footer'>
            <button style="border-right: 1px solid #7C868D;border-bottom-left-radius: 3px;">Изменить</button>
            <button style=" border-bottom-right-radius: 3px;" id='create_account' onclick="addAccount()">Удалить</button>
        </div>
    </div>
</div>

    <div class="b-popup" id="popup_z" style="display: none;">
        <div class="popup" id="popup-message" style="display: none;">
            <div class='pop_field'><p align="center" id='message_text'></p></div>
        </div>
    </div>

</body>
</html> 